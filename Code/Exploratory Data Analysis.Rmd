---
title: "Exploratory Data Analysis"
output: pdf_document
---

### **Reading and cleaning data**

First, we input our stock data.

Our stock data consists of the following indices between 2000 and 2021:

-   S&P500

-   NASDAQ

-   NYSE100

```{r}
setwd("..")
sp<-read.csv("Data/sp500.csv")
ny<-read.csv("Data/nyse.csv")
nas<-read.csv("Data/nasdaq.csv")
```

Now we will change the 'caldt' column to the Date format in order to plot the time series for each index:

```{r}
sp$caldt<-as.Date(sp$caldt, format="%d/%m/%Y")
ny$caldt<-as.Date(ny$caldt, format="%d/%m/%Y")
nas$caldt<-as.Date(nas$caldt, format="%d/%m/%Y")

str(sp)
str(ny)
str(nas)
```
### **Initial Plots**

We will start off by plotting a basic time series for each index to get an idea of what our data looks like:

```{r}
plot(sp, type='l')
plot(ny, type='l')
plot(nas, type='l')
```
They all follow the same basic pattern, which is what we would expect, with the iconic fall in stock-price during the 2008-2009 period of the 'Great Recession'.

However, the stock price directly does not give us much information. Instead, we will take at the **daily log stock returns**.

```{r}
sp_logret <- diff(log(sp$spindx))
ny_logret <- diff(log(ny$spindx))
nas_logret <- diff(log(nas$ncindx))

plot(sp$caldt[-length(sp$caldt)],sp_logret,type='l')
plot(ny$caldt[-length(ny$caldt)],ny_logret, type='l')
plot(nas$caldt[-length(nas$caldt)],nas_logret, type='l')
```
We can see that the returns average around 0% with very high variability during 2008-2009 (caused by the Great Recession) and during 2020 (caused by COVID-19).

Let us now plot the density of the returns to try to understand the distribution which will be helpful when we will try to model the returns later one:

```{r}
plot(density(sp_logret))
plot(density(ny_logret))
plot(density(nas_logret))
```
The returns look like they follow a normal distribution. So, we will make qq-plots to further confirm this:

```{r}
qqnorm(sp_logret)
qqline(sp_logret,col='red')

qqnorm(ny_logret)
qqline(ny_logret,col='red')

qqnorm(nas_logret)
qqline(nas_logret,col='red')
```

 The log-returns have much heavier tails than the normal distribution, which suggests that it might follow a Student's t-distribution. Let's explore this further:
 
```{r}

```

```{r}
acf(sp_logret)
acf(ny_logret)
acf(nas_logret)
```

```{r}
acf(sp_logret^2)
acf(ny_logret^2)
acf(nas_logret^2)
```
```{r}
pacf(sp_logret)
pacf(ny_logret)
pacf(nas_logret)
```

